<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:metal="http://xml.zope.org/namespaces/metal"
      xmlns:tal="http://xml.zope.org/namespaces/tal"
      xmlns:i18n="http://xml.zope.org/namespaces/i18n"
      i18n:domain="collective.object"
      metal:use-macro="context/main_template/macros/master">

      <metal:block fill-slot="main">
      <div id="content-core">

        <div class="form" metal:define-macro="form">

            <metal:define define-macro="titlelessform">

                <tal:status define="status view/status;
                                    has_error python:view.widgets.errors or status == getattr(view, 'formErrorsMessage', None)" condition="status">
                    <dl class="portalMessage error" tal:condition="has_error">
                        <dt i18n:translate="">
                            Error
                        </dt>
                        <dd tal:content="status" />
                    </dl>
                    <dl class="portalMessage info" tal:condition="not:has_error">
                        <dt i18n:translate="">
                            Info
                        </dt>
                        <dd tal:content="status" />
                    </dl>
                </tal:status>

                <tal:errors define="errors view/widgets/errors" condition="errors">
                    <tal:error repeat="error errors">
                        <div class="field error"
                             tal:condition="not:nocall:error/widget"
                             tal:content="structure error/render">
                             Error
                        </div>
                    </tal:error>
                </tal:errors>

                <metal:description-slot define-slot="description">
                  <p  class="discreet"
                      tal:define="description view/description | nothing"
                      tal:condition="description"
                      tal:content="structure description">
                          Description
                  </p>
                </metal:description-slot>

                <form class="rowlike enableUnloadProtection" action="." method="post"
                      tal:define="groups view/groups | nothing;
                                  form_name view/form_name | nothing;
                                  form_class view/css_class | string:;
                                  default_fieldset_label view/default_fieldset_label | form_name;
                                  enable_form_tabbing view/enable_form_tabbing | python:True;
                                  enable_unload_protection view/enable_unload_protection|python:True;
                                  unload_protection python:enable_unload_protection and 'enableUnloadProtection';
                                  has_groups python:bool(groups);
                                  form_tabbing python:(has_groups and enable_form_tabbing) and 'enableFormTabbing' or '';
                                  show_default_label python:has_groups and default_fieldset_label and len(view.widgets);
                                  "
                      tal:attributes="action view/action|request/getURL;
                                      enctype view/enctype;
                                      class python:'rowlike %s %s %s kssattr-formname-%s' % (unload_protection, form_tabbing, form_class, view.__name__ or request.getURL().split('/')[-1]);
                                      id view/id;
                                      method view/method|string:'post'
                                      ">

                    <metal:block define-slot="formtop" />

                    <metal:fields-slot define-slot="fields">
                      <input type="hidden"
                          name="fieldset"
                          tal:define="current_fieldset request/fieldset | python:None"
                          tal:condition="python:has_groups and enable_form_tabbing and current_fieldset is not None"
                          tal:attributes="value current_fieldset"
                          />

                      <!-- Default fieldset -->
                      <metal:define
                          define-macro="fields"
                          tal:define="show_default_label show_default_label|nothing;
                                      has_groups has_groups|nothing">

                          <fieldset id="fieldset-default" tal:omit-tag="not:show_default_label">

                              <legend tal:condition="show_default_label"
                                      tal:attributes="id string:fieldsetlegend-default"
                                      tal:content="default_fieldset_label">Form name</legend>

                              <metal:define define-macro="widget_rendering">
                                  <tal:widgets repeat="widget view/widgets/values">
                                      <metal:field-slot define-slot="field">
                                          <metal:field define-macro="field">
                                              <tal:widget tal:replace="structure widget/@@ploneform-render-widget"/>
                                          </metal:field>
                                      </metal:field-slot>
                                  </tal:widgets>
                              </metal:define>
                          </fieldset>

                          <!-- Secondary fieldsets -->
                          <tal:block tal:repeat="group groups" condition="has_groups">
                              
                              <fieldset
                                  tal:define="normalizeString nocall:context/@@plone/normalizeString;
                                              fieldset_label group/label;
                                              fieldset_name group/__name__|group/label/default|fieldset_label;
                                              fieldset_name python:normalizeString(fieldset_name);"
                                  tal:attributes="id string:fieldset-${fieldset_name};
                                                  class string:kssattr-fieldset-${fieldset_name};
                                                  data-fieldset fieldset_name">
                                      
                                      <!-- Identification -->
                                      <legend tal:condition="fieldset_label"
                                              tal:attributes="id string:fieldsetlegend-${fieldset_name}"
                                              tal:content="fieldset_label">Form name</legend>

                                      <p i18n:translate=""
                                         tal:define="group_description group/description|nothing"
                                         tal:condition="group_description"
                                         tal:content="structure group_description">
                                          Description
                                      </p>

                                      <tal:block tal:define="errors group/widgets/errors"
                                                 tal:condition="errors"
                                                 tal:repeat="error errors">
                                          <div class="field error"
                                              tal:condition="not:nocall:error/widget"
                                              tal:content="structure error/render"
                                              />
                                      </tal:block>

                                      <!-- Identification -->
                                      <tal:identification tal:condition='python: fieldset_name == "identification"'
                                        tal:define='widgets group/widgets'>

                                          <div class="row no-padding">
                                            
                                            <h2 class="page-header" i18n:translate="">Identification</h2>
                                        
                                            <div class="form-horizontal">
                                            
                                              <tal:widget tal:replace="structure widgets/institution_name/@@ploneform-render-widget"/>
                                              <tal:widget tal:replace="structure widgets/administrative_name/@@ploneform-render-widget"/>
                                              <tal:widget tal:replace="structure widgets/collection/@@ploneform-render-widget"/>
                                              
                                              <tal:widget tal:replace="structure widgets/object_number/@@ploneform-render-widget"/>
                                              <tal:widget tal:replace="structure widgets/rec_type/@@ploneform-render-widget"/>
                                              
                                              <div class="col-sm-12 col-md-6 col-lg-6 padding-right div-50">
                                                <tal:widget tal:replace="structure widgets/part/@@ploneform-render-widget"/>
                                              </div>

                                              <div class="col-sm-12 col-md-6 col-lg-6 div-20-80 label-right">
                                                <tal:widget tal:replace="structure widgets/tot_number/@@ploneform-render-widget"/>
                                              </div>

                                              <div class="col-sm-12 col-md-6 col-lg-6 padding-right div-50">
                                                <tal:widget tal:replace="structure widgets/copy_number/@@ploneform-render-widget"/>
                                              </div>

                                              <div class="col-sm-12 col-md-6 col-lg-6 div-20-80 label-right">
                                                <tal:widget tal:replace="structure widgets/edition/@@ploneform-render-widget"/>
                                              </div>

                                              <tal:widget tal:replace="structure widgets/distinguish_features/@@ploneform-render-widget"/>

                                            </div>

                                            <h2 class="page-header" i18n:translate="">Object name</h2>

                                            <div class="form-horizontal">
                                              <tal:widget tal:replace="structure widgets/object_category/@@ploneform-render-widget"/>
                                              <tal:widget tal:replace="structure widgets/object_name/@@ploneform-render-widget"/>
                                              <tal:widget tal:replace="structure widgets/other_name/@@ploneform-render-widget"/>
                                            </div>
                                          </div>


                                      </tal:identification>

                                      <!-- Physical Characteristics -->
                                      <tal:physical_characteristics tal:condition='python: fieldset_name == "physical_characteristics"'
                                        tal:define='widgets group/widgets'>
                                        <div class="row no-padding">
                                          <h2 class="page-header" i18n:translate="">Physical Description</h2>

                                          <div class="form-horizontal">
                                            <tal:widget tal:replace="structure widgets/physical_description/@@ploneform-render-widget"/>
                                          </div>

                                          <h2 class="page-header" i18n:translate="">Keywords</h2>
                                          <div class="form-horizontal gridfield table-responsive">
                                            <tal:widget tal:replace="structure widgets/keywords/@@ploneform-render-widget"/>
                                          </div>

                                          <h2 class="page-header" i18n:translate="">Techniques</h2>
                                          <div class="form-horizontal gridfield table-responsive">
                                            <tal:widget tal:replace="structure widgets/techniques/@@ploneform-render-widget"/>
                                          </div>

                                          <h2 class="page-header" i18n:translate="">Materials</h2>
                                          <div class="form-horizontal gridfield table-responsive">
                                            <tal:widget tal:replace="structure widgets/materials/@@ploneform-render-widget"/>
                                          </div>

                                          <h2 class="page-header" i18n:translate="">Dimensions</h2>
                                          <div class="form-horizontal gridfield table-responsive">
                                            <tal:widget tal:replace="structure widgets/dimensions/@@ploneform-render-widget"/>
                                          </div>

                                          <div class="form-horizontal">
                                            <tal:widget tal:replace="structure widgets/dimensions_free_text/@@ploneform-render-widget"/>
                                          </div>

                                          <h2 class="page-header" i18n:translate="">Frame</h2>
                                          <div class="form-horizontal">
                                            <div class="col-sm-12 col-md-6 col-lg-6 padding-right div-50">
                                                <tal:widget tal:replace="structure widgets/frame/@@ploneform-render-widget"/>
                                            </div>
                                            <div class="col-sm-12 col-md-6 col-lg-6 div-40-60 label-right">
                                              <tal:widget tal:replace="structure widgets/frame_detail/@@ploneform-render-widget"/>
                                            </div>
                                          </div>
                                        </div>
                                      </tal:physical_characteristics>

                                      <!-- Production | Dating -->
                                      <tal:production_dating tal:condition='python: fieldset_name == "production_dating"'
                                        tal:define='widgets group/widgets'>
                                        <div class="row no-padding">
                                          <h2 class="page-header" i18n:translate="">Production | Dating</h2>
                                          <div class="form-horizontal">
                                            <div class="col-sm-12 col-md-6 col-lg-6 padding-right div-50">
                                              <tal:widget tal:replace="structure widgets/production_creator/@@ploneform-render-widget"/>
                                            </div>

                                            <div class="col-sm-12 col-md-6 col-lg-6 div-20-80 label-right">
                                              <tal:widget tal:replace="structure widgets/production_qualifier/@@ploneform-render-widget"/>
                                            </div>

                                            <div class="col-sm-12 col-md-6 col-lg-6 padding-right div-50">
                                              <tal:widget tal:replace="structure widgets/production_role/@@ploneform-render-widget"/>
                                            </div>

                                            <div class="col-sm-12 col-md-6 col-lg-6 div-20-80 label-right">
                                              <tal:widget tal:replace="structure widgets/production_place/@@ploneform-render-widget"/>
                                            </div>

                                            <tal:widget tal:replace="structure widgets/production_school/@@ploneform-render-widget"/>
                                            <tal:widget tal:replace="structure widgets/production_notes/@@ploneform-render-widget"/>
                                            <tal:widget tal:replace="structure widgets/production_reason/@@ploneform-render-widget"/>
                                          </div>

                                          <h2 class="page-header" i18n:translate="">Dating</h2>

                                          <div class="form-horizontal gridfield table-responsive show-label">
                                            <tal:widget tal:replace="structure widgets/production_period/@@ploneform-render-widget"/>
                                          </div>

                                          <div class="form-horizontal">
                                            <tal:widget tal:replace="structure widgets/production_dating_notes/@@ploneform-render-widget"/>
                                          </div>

                                        </div>
                                      </tal:production_dating>

                                      <!-- Condition & Conservation -->
                                      <tal:condition_conservation tal:condition='python: fieldset_name == "condition_conservation"'
                                        tal:define='widgets group/widgets'>
                                        <div class="row no-padding">
                                          <h2 class="page-header" i18n:translate="">Conservation treatment</h2>
                                          
                                          <div class="form-horizontal">
                                            <div class="col-sm-12 col-md-6 col-lg-6 padding-right div-50">
                                              <tal:widget tal:replace="structure widgets/conservation_priority/@@ploneform-render-widget"/>
                                            </div>

                                            <div class="col-sm-12 col-md-6 col-lg-6 div-20-80 label-right">
                                              
                                              <tal:widget tal:replace="structure widgets/conservation_date/@@ploneform-render-widget"/>
                                            </div>

                                            <tal:widget tal:replace="structure widgets/conservation_next_condition_check/@@ploneform-render-widget"/>
                                          </div>

                                          <h2 class="page-header" i18n:translate="">Completeness</h2>

                                          <div class="form-horizontal gridfield table-responsive">
                                            <tal:widget tal:replace="structure widgets/completeness/@@ploneform-render-widget"/>
                                          </div>

                                          <h2 class="page-header" i18n:translate="">Condition</h2>

                                          <div class="form-horizontal gridfield table-responsive">
                                            <tal:widget tal:replace="structure widgets/condition/@@ploneform-render-widget"/>
                                          </div>

                                          <h2 class="page-header" i18n:translate="">Enviromental condition</h2>

                                          <div class="form-horizontal gridfield table-responsive">
                                            <tal:widget tal:replace="structure widgets/enviromental_condition/@@ploneform-render-widget"/>
                                          </div>

                                          <h2 class="page-header" i18n:translate="">Conservation request</h2>

                                          <div class="form-horizontal gridfield table-responsive">
                                            <tal:widget tal:replace="structure widgets/conservation_request/@@ploneform-render-widget"/>
                                          </div>

                                        </div>
                                      </tal:condition_conservation>

                                      <!-- Inscriptions and markings -->
                                      <tal:inscriptions_markings tal:condition='python: fieldset_name == "inscriptions_markings"'
                                        tal:define='widgets group/widgets'>
                                        <div class="row no-padding">
                                          <h2 class="page-header" i18n:translate="">Inscriptions and markings</h2>
                              
                                            <div class="form-horizontal gridfield">
                                              <tal:widget tal:replace="structure widgets/inscriptions/@@ploneform-render-widget"/>
                                            </div>

                                        </div>
                                      </tal:inscriptions_markings>

                                      <!-- Value & Insurance -->
                                      <tal:value_insurance tal:condition='python: fieldset_name == "value_insurance"'
                                        tal:define='widgets group/widgets'>
                                        <div class="row no-padding">
                                            <h2 class="page-header" i18n:translate="">Valuation</h2>
                              
                                            <div class="form-horizontal gridfield">
                                              <tal:widget tal:replace="structure widgets/valuation/@@ploneform-render-widget"/>
                                            </div>

                                            <h2 class="page-header" i18n:translate="">Insurance</h2>
                              
                                            <div class="form-horizontal gridfield">
                                              <tal:widget tal:replace="structure widgets/insurance/@@ploneform-render-widget"/>
                                            </div>

                                        </div>
                                      </tal:value_insurance>

                              </fieldset>
                          </tal:block>
                      </metal:define>
                    </metal:fields-slot>

                    <metal:actions-slot define-slot="actions">
                        <metal:define define-macro="actions">
                            <div class="formControls" tal:condition="view/actions/values|nothing">
                                <tal:block repeat="action view/actions/values">
                                    <input type="submit" tal:replace="structure action/render" />
                                </tal:block>
                            </div>
                        </metal:define>
                    </metal:actions-slot>

                    <tal:block tal:condition="view/enableCSRFProtection|nothing"
                      tal:replace="structure context/@@authenticator/authenticator" />
                    <metal:block define-slot="formbottom" />

                </form>
            </metal:define>
        </div>
      </div>
    </metal:block>
</html>